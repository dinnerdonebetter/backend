 on: [pull_request]
 name: Tests
 jobs:
   unit_tests:
     strategy:
       matrix:
         go-version: [1.17.x]
         os: [ubuntu-latest]
     runs-on: ${{ matrix.os }}
     steps:
       - name: Install Go
         uses: actions/setup-go@v2
         with:
           go-version: ${{ matrix.go-version }}
       - name: Checkout code
         uses: actions/checkout@v2
       - name: Test build
         run: go build `go list ./... | grep -Ev '(cmd|tests|testutil|mock|fake)'`
       - name: Unit tests
         run: go test -cover -shuffle=on -race -failfast `go list ./... | grep -Ev '(cmd|tests|testutil|mock|fake)'`